<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Register Phone</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body style="font-family: sans-serif; padding: 20px;">

<h2>Register this phone for Orbis Vox notifications</h2>
<p>This only needs to be done once.</p>

<button id="btn" style="padding: 12px 16px; font-size: 16px;">
  Enable notifications
</button>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { getMessaging, getToken } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-messaging.js";

  const firebaseConfig = {
    apiKey: "AIzaSyC7G1h3vJ0bx16GtZq7g7a0MyVGWlH1UWU",
    authDomain: "orbis-vox-notify.firebaseapp.com",
    projectId: "orbis-vox-notify",
    storageBucket: "orbis-vox-notify.firebasestorage.app",
    messagingSenderId: "870786934797",
    appId: "1:870786934797:web:be0c82a3c08684637a0d44"
  };

  const vapidKey = "BGxWzY7P3p4-QLERaPBBmj0nrsaVnAQEqm358UO8Y3pxD1x23o3fRF7O6c9NUl98uvalXPteHmzb_RxkVV9h6Xw";

  const app = initializeApp(firebaseConfig);
  const messaging = getMessaging(app);

  document.getElementById("btn").onclick = async () => {
    try {
      const permission = await Notification.requestPermission();
      if (permission !== "granted") {
        alert("Notification permission denied.");
        return;
      }

      const token = await getToken(messaging, { vapidKey });

      alert(
        "SUCCESS!\n\nThis is your PHONE TOKEN.\nSave it somewhere safe:\n\n" +
        token
      );

      console.log("PHONE TOKEN:", token);
    } catch (err) {
      alert("Error:\n" + err.message);
      console.error(err);
    }
  };
</script>

</body>
</html>
